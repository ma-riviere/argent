% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/anthropic.R
\name{Anthropic}
\alias{Anthropic}
\title{Anthropic API Client}
\description{
R6 class for interacting with Anthropic's API. Provides methods for chat completions
with support for prompt caching, tool calling, and structured outputs.
}
\section{Useful links}{

\itemize{
\item API reference: https://docs.claude.com/en/api/overview
\item API docs: https://docs.claude.com/en/docs/intro
}
}

\section{Server-side tools}{

\itemize{
\item "code_execution" for bash commands and file operations (pricing: $0.05/session-hour, 5-min min)
\item "web_search" for web search capabilities. Can also be a list with \code{search_options}.
\item "web_fetch" to fetch content from a URL provided in the prompt.
}
}

\examples{
\dontrun{
# Initialize with API key from environment
anthropic <- Anthropic$new()

# Or provide API key explicitly
anthropic <- Anthropic$new(api_key = "your-api-key")

# Simple chat completion
response <- anthropic$chat(
  prompt = "What is R programming?",
  model = "claude-sonnet-4-5-20250929"
)

# With prompt caching
response <- anthropic$chat(
  prompt = "Analyze this data",
  cache_prompt = TRUE,
  cache_system = TRUE
)

# With extended thinking (10k token budget)
response <- anthropic$chat(
  prompt = "Solve this complex math problem: ...",
  thinking_budget = 10000
)

# With custom thinking budget
response <- anthropic$chat(
  prompt = "Analyze this complex scenario: ...",
  thinking_budget = 16000
)
}

## ------------------------------------------------
## Method `Anthropic$download_file`
## ------------------------------------------------

\dontrun{
anthropic <- Anthropic$new()

# Download to a directory
path <- anthropic$download_file(file_id = "file-abc123", dest_path = "downloads")

# Download with specific filename
path <- anthropic$download_file(file_id = "file-abc123", dest_path = "downloads/myfile.txt")

# Get raw bytes without saving
raw_content <- anthropic$download_file(file_id = "file-abc123", dest_path = NULL)
}
}
\section{Super class}{
\code{argent::Provider} -> \code{Anthropic}
}
\section{Public fields}{
\if{html}{\out{<div class="r6-fields">}}
\describe{
\item{\code{default_beta_features}}{Character vector. Default beta features to use for API requests}
}
\if{html}{\out{</div>}}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-Anthropic-new}{\code{Anthropic$new()}}
\item \href{#method-Anthropic-list_models}{\code{Anthropic$list_models()}}
\item \href{#method-Anthropic-get_model_info}{\code{Anthropic$get_model_info()}}
\item \href{#method-Anthropic-upload_file}{\code{Anthropic$upload_file()}}
\item \href{#method-Anthropic-get_file_metadata}{\code{Anthropic$get_file_metadata()}}
\item \href{#method-Anthropic-download_file}{\code{Anthropic$download_file()}}
\item \href{#method-Anthropic-list_files}{\code{Anthropic$list_files()}}
\item \href{#method-Anthropic-delete_file}{\code{Anthropic$delete_file()}}
\item \href{#method-Anthropic-embeddings}{\code{Anthropic$embeddings()}}
\item \href{#method-Anthropic-chat}{\code{Anthropic$chat()}}
\item \href{#method-Anthropic-clone}{\code{Anthropic$clone()}}
}
}
\if{html}{\out{
<details><summary>Inherited methods</summary>
<ul>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="download_generated_files"><a href='../../argent/html/Provider.html#method-Provider-download_generated_files'><code>argent::Provider$download_generated_files()</code></a></span></li>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="dump_history"><a href='../../argent/html/Provider.html#method-Provider-dump_history'><code>argent::Provider$dump_history()</code></a></span></li>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="get_auto_save_history"><a href='../../argent/html/Provider.html#method-Provider-get_auto_save_history'><code>argent::Provider$get_auto_save_history()</code></a></span></li>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="get_chat_history"><a href='../../argent/html/Provider.html#method-Provider-get_chat_history'><code>argent::Provider$get_chat_history()</code></a></span></li>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="get_content_text"><a href='../../argent/html/Provider.html#method-Provider-get_content_text'><code>argent::Provider$get_content_text()</code></a></span></li>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="get_generated_code"><a href='../../argent/html/Provider.html#method-Provider-get_generated_code'><code>argent::Provider$get_generated_code()</code></a></span></li>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="get_generated_files"><a href='../../argent/html/Provider.html#method-Provider-get_generated_files'><code>argent::Provider$get_generated_files()</code></a></span></li>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="get_history"><a href='../../argent/html/Provider.html#method-Provider-get_history'><code>argent::Provider$get_history()</code></a></span></li>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="get_history_file_path"><a href='../../argent/html/Provider.html#method-Provider-get_history_file_path'><code>argent::Provider$get_history_file_path()</code></a></span></li>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="get_last_response"><a href='../../argent/html/Provider.html#method-Provider-get_last_response'><code>argent::Provider$get_last_response()</code></a></span></li>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="get_rate_limit"><a href='../../argent/html/Provider.html#method-Provider-get_rate_limit'><code>argent::Provider$get_rate_limit()</code></a></span></li>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="get_reasoning_text"><a href='../../argent/html/Provider.html#method-Provider-get_reasoning_text'><code>argent::Provider$get_reasoning_text()</code></a></span></li>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="get_session_cumulative_token_count"><a href='../../argent/html/Provider.html#method-Provider-get_session_cumulative_token_count'><code>argent::Provider$get_session_cumulative_token_count()</code></a></span></li>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="get_session_history"><a href='../../argent/html/Provider.html#method-Provider-get_session_history'><code>argent::Provider$get_session_history()</code></a></span></li>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="get_session_last_token_count"><a href='../../argent/html/Provider.html#method-Provider-get_session_last_token_count'><code>argent::Provider$get_session_last_token_count()</code></a></span></li>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="get_supplementary"><a href='../../argent/html/Provider.html#method-Provider-get_supplementary'><code>argent::Provider$get_supplementary()</code></a></span></li>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="load_history"><a href='../../argent/html/Provider.html#method-Provider-load_history'><code>argent::Provider$load_history()</code></a></span></li>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="print"><a href='../../argent/html/Provider.html#method-Provider-print'><code>argent::Provider$print()</code></a></span></li>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="reset_history"><a href='../../argent/html/Provider.html#method-Provider-reset_history'><code>argent::Provider$reset_history()</code></a></span></li>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="set_auto_save_history"><a href='../../argent/html/Provider.html#method-Provider-set_auto_save_history'><code>argent::Provider$set_auto_save_history()</code></a></span></li>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="set_history"><a href='../../argent/html/Provider.html#method-Provider-set_history'><code>argent::Provider$set_history()</code></a></span></li>
<li><span class="pkg-link" data-pkg="argent" data-topic="Provider" data-id="set_rate_limit"><a href='../../argent/html/Provider.html#method-Provider-set_rate_limit'><code>argent::Provider$set_rate_limit()</code></a></span></li>
</ul>
</details>
}}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Anthropic-new"></a>}}
\if{latex}{\out{\hypertarget{method-Anthropic-new}{}}}
\subsection{Method \code{new()}}{
Initialize a new Anthropic client
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Anthropic$new(
  base_url = "https://api.anthropic.com",
  api_key = Sys.getenv("ANTHROPIC_API_KEY"),
  provider_name = "Anthropic",
  rate_limit = 50/60,
  server_tools = c("code_execution", "web_search", "web_fetch"),
  default_model = "claude-haiku-4-5-20251001",
  auto_save_history = TRUE
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{base_url}}{Character. Base URL for API (default: "https://api.anthropic.com")}

\item{\code{api_key}}{Character. API key (default: from ANTHROPIC_API_KEY env var)}

\item{\code{provider_name}}{Character. Provider name (default: "Anthropic")}

\item{\code{rate_limit}}{Numeric. Rate limit in requests per second (default: 50/60)}

\item{\code{server_tools}}{Character vector. Server-side tools available (default: c("code_execution",
"web_search", "web_fetch"))}

\item{\code{default_model}}{Character. Default model to use for chat requests (default:
"claude-haiku-4-5-20251001")}

\item{\code{auto_save_history}}{Logical. Enable/disable automatic history sync (default: TRUE)}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Anthropic-list_models"></a>}}
\if{latex}{\out{\hypertarget{method-Anthropic-list_models}{}}}
\subsection{Method \code{list_models()}}{
List all available Anthropic models
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Anthropic$list_models()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Data frame. Available models with their specifications
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Anthropic-get_model_info"></a>}}
\if{latex}{\out{\hypertarget{method-Anthropic-get_model_info}{}}}
\subsection{Method \code{get_model_info()}}{
Get information about a specific Anthropic model
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Anthropic$get_model_info(model_id)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{model_id}}{Character. Model ID (e.g., "claude-sonnet-4-5-20250929")}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
List. Model information
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Anthropic-upload_file"></a>}}
\if{latex}{\out{\hypertarget{method-Anthropic-upload_file}{}}}
\subsection{Method \code{upload_file()}}{
Upload a file to Anthropic Files API
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Anthropic$upload_file(file_path, file_name = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{file_path}}{Character. Path to the file to upload, or URL to a remote file}

\item{\code{file_name}}{Character. Optional custom name for the uploaded file. If NULL (default),
uses the basename of file_path.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
List. File metadata or NULL on error
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Anthropic-get_file_metadata"></a>}}
\if{latex}{\out{\hypertarget{method-Anthropic-get_file_metadata}{}}}
\subsection{Method \code{get_file_metadata()}}{
Get metadata for an uploaded file
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Anthropic$get_file_metadata(file_id)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{file_id}}{Character. File ID (e.g., "file-abc123")}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
List. File metadata or NULL on error
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Anthropic-download_file"></a>}}
\if{latex}{\out{\hypertarget{method-Anthropic-download_file}{}}}
\subsection{Method \code{download_file()}}{
Download file content. Only files created by Anthropic's Code Execution tool can be downloaded.

Downloads the file content and saves it to the specified path. If dest_path is a directory,
the file is saved with its original filename. If dest_path is a file path, it is used as
the complete destination path.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Anthropic$download_file(file_id, dest_path = "data", overwrite = TRUE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{file_id}}{Character. File ID (e.g., "file-abc123")}

\item{\code{dest_path}}{Character. Destination path (default: "data"). Can be either a directory
path or a complete file path. If NULL, returns content as raw bytes without saving.
Created if it doesn't exist.}

\item{\code{overwrite}}{Logical. Whether to overwrite existing files (default: TRUE).}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Raw vector (if dest_path is NULL) or Character path to downloaded file (invisibly)
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{\dontrun{
anthropic <- Anthropic$new()

# Download to a directory
path <- anthropic$download_file(file_id = "file-abc123", dest_path = "downloads")

# Download with specific filename
path <- anthropic$download_file(file_id = "file-abc123", dest_path = "downloads/myfile.txt")

# Get raw bytes without saving
raw_content <- anthropic$download_file(file_id = "file-abc123", dest_path = NULL)
}
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Anthropic-list_files"></a>}}
\if{latex}{\out{\hypertarget{method-Anthropic-list_files}{}}}
\subsection{Method \code{list_files()}}{
List all uploaded files
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Anthropic$list_files(
  limit = 20,
  before_id = NULL,
  after_id = NULL,
  as_df = TRUE
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{limit}}{Integer. Number of files per page (default: 20, max: 1000)}

\item{\code{before_id}}{Character. ID for pagination (optional)}

\item{\code{after_id}}{Character. ID for pagination (optional)}

\item{\code{as_df}}{Logical. Whether to return files as a data frame (default: TRUE). If FALSE, returns raw list.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Data frame (if as_df = TRUE) or list (if as_df = FALSE). Files metadata and pagination info.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Anthropic-delete_file"></a>}}
\if{latex}{\out{\hypertarget{method-Anthropic-delete_file}{}}}
\subsection{Method \code{delete_file()}}{
Delete an uploaded file
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Anthropic$delete_file(file_id)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{file_id}}{Character. File ID (e.g., "file-abc123")}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Logical. TRUE if successful, FALSE otherwise
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Anthropic-embeddings"></a>}}
\if{latex}{\out{\hypertarget{method-Anthropic-embeddings}{}}}
\subsection{Method \code{embeddings()}}{
Generate embeddings for text input

Note: Anthropic does not provide a native embeddings API. For embeddings, consider using:
\itemize{
\item Voyage AI (recommended by Anthropic)
\item OpenAI (text-embedding-3-small, text-embedding-3-large)
\item Google (text-embedding-004)
\item Other embedding providers available through OpenRouter
}
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Anthropic$embeddings(...)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{...}}{Arguments (not used, included for method signature consistency)}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
This method always throws an error
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Anthropic-chat"></a>}}
\if{latex}{\out{\hypertarget{method-Anthropic-chat}{}}}
\subsection{Method \code{chat()}}{
Send a chat completion request to Anthropic
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Anthropic$chat(
  ...,
  cache_prompt = FALSE,
  model = "claude-haiku-4-5-20251001",
  system = .default_system_prompt,
  cache_system = FALSE,
  max_tokens = 4096,
  temperature = 1,
  top_p = NULL,
  top_k = NULL,
  tools = NULL,
  tool_choice = list(type = "auto"),
  cache_tools = FALSE,
  output_schema = NULL,
  thinking_budget = 0,
  return_full_response = FALSE
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{...}}{One or more inputs for the prompt. Can be text strings, file paths, URLs, R objects,
or content wrapped with \verb{as_*_content()} functions. R objects (but not plain strings) will
include their names and structure in the context sent to the model.}

\item{\code{cache_prompt}}{Logical. Cache the prompt for reuse (default: FALSE)}

\item{\code{model}}{Character. Model to use (default: "claude-haiku-4-5-20251001")}

\item{\code{system}}{Character. System instructions (optional)}

\item{\code{cache_system}}{Logical. Cache system instructions (default: FALSE)}

\item{\code{max_tokens}}{Integer. Maximum tokens to generate (default: 4096)}

\item{\code{temperature}}{Numeric. Sampling temperature (default: 1). Range: 0.0-1.0}

\item{\code{top_p}}{Numeric. Nucleus sampling - use cumulative probability distribution. Range: 0.0-1.0
(optional). Should be used instead of temperature for advanced use cases}

\item{\code{top_k}}{Integer. Sample from top K options only. Minimum: 0 (optional). For advanced use cases}

\item{\code{tools}}{List. Tool definitions (server-side or client-side functions). Server-side tools:
\itemize{
\item "code_execution" for bash commands and file operations (pricing: $0.05/session-hour, 5-min min)
\item list(type = "code_execution", container = container_id) to reuse an existing container
\item "web_search" for web search capabilities. Can also be a list with \code{search_options}.
\item "web_fetch" to fetch content from a URL provided in the prompt.
Client-side functions: created with the \code{as_tool(fn)} or \code{tool()} helpers.
Note: Code execution has no internet access, 5GB RAM/disk, 1 CPU.
Containers expire 30 days after creation.
}}

\item{\code{tool_choice}}{List. Tool choice configuration: list(type = "auto"), list(type = "any"),
list(type = "tool", name = "tool_name"), or NULL for none (default: list(type = "auto"))}

\item{\code{cache_tools}}{Logical. Cache tool definitions (default: FALSE)}

\item{\code{output_schema}}{List. JSON schema for structured output (optional)}

\item{\code{thinking_budget}}{Integer. Thinking budget in tokens: 0 (disabled), or 1024-max_tokens
(default: 0). Minimum is 1024 tokens.}

\item{\code{return_full_response}}{Logical. Return full API response (default: FALSE)}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Character (or List if return_full_response = TRUE). Anthropic API's response object.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Anthropic-clone"></a>}}
\if{latex}{\out{\hypertarget{method-Anthropic-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Anthropic$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
