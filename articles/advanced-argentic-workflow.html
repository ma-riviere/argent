<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Advanced Agentic Workflows • argent</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="advanced-argentic-workflow_files/libs/quarto-html/popper.min.js"></script><script src="advanced-argentic-workflow_files/libs/quarto-html/tippy.umd.min.js"></script><link href="advanced-argentic-workflow_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="advanced-argentic-workflow_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Advanced Agentic Workflows">
<meta property="og:image" content="https://ma-riviere.github.io/argent/reference/figures/logo.png">
<meta property="og:image:alt" content="Creating AI Agents in R">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@mariviere1">
<meta name="twitter:site" content="@mariviere1">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">argent</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/argent.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-providers" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Providers</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-providers">
<li><a class="dropdown-item" href="../articles/google-gemini.html">Google Gemini</a></li>
    <li><a class="dropdown-item" href="../articles/anthropic.html">Anthropic</a></li>
    <li><a class="dropdown-item" href="../articles/openrouter.html">OpenRouter</a></li>
    <li><a class="dropdown-item" href="../articles/local-llm.html">Local LLM</a></li>
    <li><a class="dropdown-item" href="../articles/other-providers.html">Other Providers</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>OpenAI</h6></li>
    <li><a class="dropdown-item" href="../articles/openai-responses.html">Responses API</a></li>
    <li><a class="dropdown-item" href="../articles/openai-completions.html">Chat Completions API</a></li>
    <li><a class="dropdown-item" href="../articles/openai-assistants.html">Assistants API</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-advanced-use" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Advanced Use</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-advanced-use">
<li><a class="dropdown-item" href="../articles/advanced-rag.html">RAG with `ragnar`</a></li>
    <li><a class="dropdown-item" href="../articles/advanced-mcp.html">Using MCP Servers</a></li>
    <li><a class="dropdown-item" href="../articles/advanced-argentic-workflow.html">Advanced Argentic Workflow</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ma-riviere/argent/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Advanced Agentic Workflows</h1>




      <small class="dont-index">Source: <a href="https://github.com/ma-riviere/argent/blob/main/vignettes/articles/advanced-argentic-workflow.qmd" class="external-link"><code>vignettes/articles/advanced-argentic-workflow.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <section class="section level2"><h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This article demonstrates how to build agentic workflows, with sub-agents.</p>
<p>Instead of giving one agent all the tools and all the tasks, we create specialized sub-agents that excel at specific responsibilities while a main orchestrator coordinates their work. This avoids clogging the main agent’s context window, and to reduce cost by delegating specific sub-tasks to less expensive models.</p>
</section><section class="section level2"><h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mirai</span><span class="fu">::</span><span class="fu"><a href="https://mirai.r-lib.org/reference/daemons.html" class="external-link">daemons</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span> <span class="co"># Enable parallel tool calling</span></span></code></pre></div>
</div>
</section><section class="section level2"><h2 id="building-our-tools">Building our Tools<a class="anchor" aria-label="anchor" href="#building-our-tools"></a>
</h2>
<p>First, let’s build a few tools that our agents will need:</p>
<section class="level2"><h3 id="web-tools">Web Tools<a class="anchor" aria-label="anchor" href="#web-tools"></a>
</h3>
<p><strong>Search:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">web_search</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">query</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co">#' @description Search the web for information using Tavily API. Returns a JSON array of search results with titles, URLs, and content snippets. Use this when you need current information, facts, news, or any data not in your training data.</span></span>
<span>    <span class="co">#' @param query:string* The search query string. Be specific and use keywords that will yield the most relevant results.</span></span>
<span>    </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">web_search_tavily</span><span class="op">(</span><span class="va">query</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">web_search_tavily</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">query</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">httr2</span><span class="fu">::</span><span class="fu"><a href="https://httr2.r-lib.org/reference/request.html" class="external-link">request</a></span><span class="op">(</span><span class="st">"https://api.tavily.com/search"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">httr2</span><span class="fu">::</span><span class="fu"><a href="https://httr2.r-lib.org/reference/req_body.html" class="external-link">req_body_json</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>            query <span class="op">=</span> <span class="va">query</span>,</span>
<span>            search_depth <span class="op">=</span> <span class="st">"basic"</span>,</span>
<span>            include_answer <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>            max_results <span class="op">=</span> <span class="fl">10</span>,</span>
<span>            api_key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"TAVILY_API_KEY"</span><span class="op">)</span></span>
<span>        <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">httr2</span><span class="fu">::</span><span class="fu"><a href="https://httr2.r-lib.org/reference/req_error.html" class="external-link">req_error</a></span><span class="op">(</span>is_error <span class="op">=</span> \<span class="op">(</span><span class="va">resp</span><span class="op">)</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">httr2</span><span class="fu">::</span><span class="fu"><a href="https://httr2.r-lib.org/reference/req_throttle.html" class="external-link">req_throttle</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">20</span><span class="op">/</span><span class="fl">60</span>, realm <span class="op">=</span> <span class="st">"tavily"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">httr2</span><span class="fu">::</span><span class="fu"><a href="https://httr2.r-lib.org/reference/req_perform.html" class="external-link">req_perform</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">httr2</span><span class="fu">::</span><span class="fu"><a href="https://httr2.r-lib.org/reference/resp_body_raw.html" class="external-link">resp_body_json</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/keep_at.html" class="external-link">discard_at</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"response_time"</span>, <span class="st">"follow_up_questions"</span>, <span class="st">"images"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">results</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/keep_at.html" class="external-link">discard_at</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"raw_content"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://jeroen.r-universe.dev/jsonlite/reference/fromJSON.html" class="external-link">toJSON</a></span><span class="op">(</span><span class="va">results</span>, pretty <span class="op">=</span> <span class="cn">FALSE</span>, auto_unbox <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<p><strong>Fetch:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">web_fetch</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">url</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co">#' @description Fetch and extract the main text content from a web page as clean markdown. Returns the page content with formatting preserved, stripped of navigation, ads, and boilerplate. Use this to read articles, documentation, blog posts, or any web page content.</span></span>
<span>    <span class="co">#' @param url:string* The complete URL of the web page to fetch (e.g., "https://example.com/article"). Must be a valid HTTP/HTTPS URL.</span></span>
<span>    </span>
<span>    <span class="va">trafilatura_installed</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/system.html" class="external-link">system</a></span><span class="op">(</span><span class="st">"which trafilatura"</span>, intern <span class="op">=</span> <span class="cn">TRUE</span>, ignore.stderr <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    warning <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html" class="external-link">cli_alert_warning</a></span><span class="op">(</span><span class="st">"trafilatura is not installed. Install with: {.code pip install trafilatura}"</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">trafilatura_installed</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">web_fetch_trafilatura</span><span class="op">(</span><span class="va">url</span><span class="op">)</span></span>
<span></span>
<span>        <span class="va">could_not_fetch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>            <span class="st">"Impossible to fetch the contents of this web page"</span>,</span>
<span>            <span class="st">"Please reload this page"</span>,</span>
<span>            <span class="st">"There was an error while loading"</span>,</span>
<span>            <span class="st">"404"</span></span>
<span>        <span class="op">)</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">||</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">res</span>, <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/modifiers.html" class="external-link">fixed</a></span><span class="op">(</span><span class="va">could_not_fetch</span>, ignore_case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">web_fetch_rvest</span><span class="op">(</span><span class="va">url</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">web_fetch_rvest</span><span class="op">(</span><span class="va">url</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">web_fetch_trafilatura</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">url</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># pip install trafilatura</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="op">{</span></span>
<span>        <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"trafilatura -u "</span>, <span class="va">url</span>, <span class="st">" --markdown --no-comments --links "</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/system.html" class="external-link">system</a></span><span class="op">(</span>intern <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>            <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">keep</a></span><span class="op">(</span><span class="va">nzchar</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span>collapse <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span>        </span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="st">"Impossible to fetch the contents of this web page. It might not allow scraping"</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">web_fetch_rvest</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">url</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">tags_to_ignore</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"a"</span>, <span class="st">"script"</span>, <span class="st">"code"</span>, <span class="st">"img"</span>, <span class="st">"svg"</span>, <span class="st">"footer"</span>, <span class="st">"g"</span>, <span class="st">"path"</span>, <span class="st">"polygon"</span>, <span class="st">"label"</span>, <span class="st">"button"</span>, <span class="st">"form"</span>, <span class="st">"input"</span>, <span class="st">"select"</span>, </span>
<span>        <span class="st">"style"</span>, <span class="st">"link"</span>, <span class="st">"meta"</span>, <span class="st">"noscript"</span>, <span class="st">"iframe"</span>, <span class="st">"embed"</span>, <span class="st">"object"</span>, <span class="st">"param"</span>, <span class="st">"video"</span>, <span class="st">"audio"</span>, <span class="st">"track"</span>, <span class="st">"source"</span>, </span>
<span>        <span class="st">"canvas"</span>, <span class="st">"map"</span>, <span class="st">"area"</span>, <span class="st">"math"</span>, <span class="st">"col"</span>, <span class="st">"colgroup"</span>, <span class="st">"dl"</span>, <span class="st">"dt"</span>, <span class="st">"dd"</span>, <span class="st">"hr"</span>, <span class="st">"pre"</span>, <span class="st">"address"</span>, <span class="st">"figure"</span>, <span class="st">"figcaption"</span>,</span>
<span>        <span class="st">"dfn"</span>, <span class="st">"em"</span>, <span class="st">"kbd"</span>, <span class="st">"samp"</span>, <span class="st">"var"</span>, <span class="st">"del"</span>, <span class="st">"ins"</span>, <span class="st">"mark"</span>, <span class="st">"circle"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="va">remove_tags</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">xml</span>, <span class="va">tags</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">walk</a></span><span class="op">(</span><span class="va">tags</span>, \<span class="op">(</span><span class="va">tag</span><span class="op">)</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">walk</a></span><span class="op">(</span><span class="fu">xml2</span><span class="fu">::</span><span class="fu"><a href="http://xml2.r-lib.org/reference/xml_find_all.html" class="external-link">xml_find_all</a></span><span class="op">(</span><span class="va">xml</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">".//"</span>, <span class="va">tag</span><span class="op">)</span><span class="op">)</span>, \<span class="op">(</span><span class="va">node</span><span class="op">)</span> <span class="fu">xml2</span><span class="fu">::</span><span class="fu"><a href="http://xml2.r-lib.org/reference/xml_replace.html" class="external-link">xml_remove</a></span><span class="op">(</span><span class="va">node</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">xml</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="va">cleaned_contents</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>        <span class="fu">rvest</span><span class="fu">::</span><span class="fu"><a href="http://xml2.r-lib.org/reference/read_xml.html" class="external-link">read_html</a></span><span class="op">(</span><span class="va">url</span><span class="op">)</span></span>
<span>        <span class="op">|&gt;</span> <span class="fu">rvest</span><span class="fu">::</span><span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html" class="external-link">html_element</a></span><span class="op">(</span><span class="st">"body"</span><span class="op">)</span></span>
<span>        <span class="op">|&gt;</span> <span class="fu">remove_tags</span><span class="op">(</span><span class="va">tags_to_ignore</span><span class="op">)</span></span>
<span>        <span class="op">|&gt;</span> <span class="fu">rvest</span><span class="fu">::</span><span class="fu"><a href="https://rvest.tidyverse.org/reference/html_children.html" class="external-link">html_children</a></span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="op">|&gt;</span> <span class="fu">rvest</span><span class="fu">::</span><span class="fu"><a href="https://rvest.tidyverse.org/reference/html_text.html" class="external-link">html_text2</a></span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="op">|&gt;</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">==</span> <span class="st">""</span><span class="op">)</span></span>
<span>        <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span>collapse <span class="op">=</span> <span class="st">"\n\n"</span><span class="op">)</span>,</span>
<span>        error <span class="op">=</span> \<span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">cleaned_contents</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</section><section class="level2"><h3 id="todo-list-tools">TODO-list Tools<a class="anchor" aria-label="anchor" href="#todo-list-tools"></a>
</h3>
<p>Let’s build a TODO-list tool that provides agents with a way to track multi-step work.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a TODO-list</span></span>
<span><span class="va">create_todo_list</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">new.env</a></span><span class="op">(</span>parent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">emptyenv</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">env</span><span class="op">$</span><span class="va">todos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">env</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Get the current TODOs from a given TODO-list</span></span>
<span><span class="va">get_todos</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">todo_mgr</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">todo_mgr</span><span class="op">$</span><span class="va">todos</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Set the TODOs of a given TODO-list</span></span>
<span><span class="va">set_todos</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">todo_mgr</span>, <span class="va">todos</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Validate input structure</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span><span class="op">(</span><span class="va">todos</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="st">"Error: todos must be a list"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="va">errors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">todos</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">todo</span> <span class="op">&lt;-</span> <span class="va">todos</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span>        <span class="co"># Check required fields</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"content"</span>, <span class="st">"status"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">todo</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">errors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">errors</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Todo %d missing required fields (content, status)"</span>, <span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span></span>
<span>        <span class="co"># Validate status</span></span>
<span>        <span class="va">valid_statuses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pending"</span>, <span class="st">"in_progress"</span>, <span class="st">"completed"</span><span class="op">)</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">todo</span><span class="op">$</span><span class="va">status</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">valid_statuses</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">errors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">errors</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span></span>
<span>                <span class="st">"Todo %d has invalid status '%s'. Must be one of: %s"</span>,</span>
<span>                <span class="va">i</span>, <span class="va">todo</span><span class="op">$</span><span class="va">status</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">valid_statuses</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span></span>
<span>            <span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">errors</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Errors found:"</span>, <span class="va">errors</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">"\\n- "</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="va">todo_mgr</span><span class="op">$</span><span class="va">todos</span> <span class="op">&lt;-</span> <span class="va">todos</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Successfully updated %d TODO(s)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">todos</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</section><section class="level2"><h3 id="github-mcp-tools">GitHub MCP Tools<a class="anchor" aria-label="anchor" href="#github-mcp-tools"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">github_mcp_server</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcp_integration.html">mcp_server</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"github"</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"http"</span>,</span>
<span>    url <span class="op">=</span> <span class="st">"https://api.githubcopilot.com/mcp"</span>,</span>
<span>    headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Authorization <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Bearer"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"GITHUB_PAT"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">github_mcp_tools</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcp_integration.html">mcp_tools</a></span><span class="op">(</span><span class="va">github_mcp_server</span>, tools <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"search_code"</span>, <span class="st">"get_file_contents"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div>
<blockquote>
<p><strong>Note</strong></p>
<p>See the <a href="../articles/advanced-mcp.qmd">Using MCP Servers with <code>argent</code></a> article for more details on how to use MCP servers with <code>argent</code>.</p>
</blockquote>
</div>
</section></section><section class="section level2"><h2 id="creating-our-agents">Creating our Agents<a class="anchor" aria-label="anchor" href="#creating-our-agents"></a>
</h2>
<p>For this example, we will have one main/orchestrator agent, and two sub-agents: a planning sub-agent and a (web/github) research sub-agent.</p>
<section class="level2"><h3 id="planning-sub-agent">Planning Sub-Agent<a class="anchor" aria-label="anchor" href="#planning-sub-agent"></a>
</h3>
<p>The planning sub-agent’s role us to analyze complex requests and breaks them into a set of actionable tasks. It uses a web search tool to understand the domain and creates a structured plan using a TODO-list tool.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">planning_subagent</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">task</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co">#' @description Creates a planning sub-agent that analyzes a complex task and breaks it down</span></span>
<span>    <span class="co">#'   into structured sub-tasks. Use this tool FIRST to create a roadmap for complex requests.</span></span>
<span>    <span class="co">#' @param task:string* The complex research task to plan. The tool will return a list of sub-tasks to enact.</span></span>
<span></span>
<span>    <span class="co"># Create a fresh TODO-list for this planning subagent</span></span>
<span>    <span class="va">todo_list</span> <span class="op">&lt;-</span> <span class="fu">create_todo_list</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">planner</span> <span class="op">&lt;-</span> <span class="fu">argent</span><span class="fu">::</span><span class="va"><a href="../reference/OpenRouter.html">OpenRouter</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>default_model <span class="op">=</span> <span class="st">"x-ai/grok-4.1-fast"</span>, auto_save_history <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">planning_system</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html" class="external-link">str_glue</a></span><span class="op">(</span></span>
<span>        <span class="st">"You are a Lead Architect and Planning Specialist.</span></span>
<span><span class="st">        Your goal is to analyze complex requests and break them down into clear, actionable</span></span>
<span><span class="st">        sub-tasks.</span></span>
<span><span class="st"></span></span>
<span><span class="st">        &lt;process&gt;</span></span>
<span><span class="st">        1. ANALYZE: Use `web_search` to understand the domain and identify key components.</span></span>
<span><span class="st">        2. THINK: Reflect on the necessary steps to achieve the user's goal.</span></span>
<span><span class="st">        3. PLAN: Use `set_todos` to create a comprehensive plan.</span></span>
<span><span class="st">        4. SUMMARIZE: Return a concise 'Handoff Summary' explaining the strategy.</span></span>
<span><span class="st">        &lt;/process&gt;</span></span>
<span><span class="st"></span></span>
<span><span class="st">        &lt;guidelines&gt;</span></span>
<span><span class="st">        - Create independent sub-tasks that can be delegated to a research specialist</span></span>
<span><span class="st">           with access to web pages &amp; GitHub code repositories.</span></span>
<span><span class="st">        - Be specific about what needs to be researched or implemented in each step.</span></span>
<span><span class="st">        - Do not attempt to execute the research yourself, only plan it.</span></span>
<span><span class="st">        &lt;/guidelines&gt;</span></span>
<span><span class="st"></span></span>
<span><span class="st">        The current date is {lubridate::today()}."</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="va">planning_prompt</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html" class="external-link">str_glue</a></span><span class="op">(</span></span>
<span>        <span class="st">"Analyze this task and create a detailed plan:\\n\\n&lt;task&gt;\\n{task}\\n&lt;/task&gt;"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Create closure-based tools that bind to this todo_manager instance</span></span>
<span>    <span class="va">get_todos_planner</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="co">#' @description Get the current TODO list</span></span>
<span>        <span class="fu">get_todos</span><span class="op">(</span><span class="va">todo_list</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">get_todos_planner_tool</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tool_definitions.html">as_tool</a></span><span class="op">(</span><span class="va">get_todos_planner</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">set_todos_planner</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">todos</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu">set_todos</span><span class="op">(</span><span class="va">todo_list</span>, <span class="va">todos</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="co"># We define the tool manually since there is no way to specify nested lists as function annotations.</span></span>
<span>    <span class="va">set_todos_planner_tool</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tool_definitions.html">tool</a></span><span class="op">(</span></span>
<span>        name <span class="op">=</span> <span class="st">"set_todos_planner"</span>,</span>
<span>        description <span class="op">=</span> <span class="st">"Update your task list for planning and tracking multi-step work. This</span></span>
<span><span class="st">            replaces the entire TODO list. Always include all TODOs (completed, in_progress, and</span></span>
<span><span class="st">            pending) as a list of objects."</span>,</span>
<span>        todos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>            type <span class="op">=</span> <span class="st">"[object]*"</span>,</span>
<span>            description <span class="op">=</span> <span class="st">"List of TODO items, each with 'content' (string) and 'status'</span></span>
<span><span class="st">                (pending, in_progress, or completed)"</span>,</span>
<span>            content <span class="op">=</span> <span class="st">"string* Task description"</span>,</span>
<span>            status <span class="op">=</span> <span class="st">"string* One of: 'pending', 'in_progress', or 'completed'"</span></span>
<span>        <span class="op">)</span>,</span>
<span>        fn <span class="op">=</span> <span class="va">set_todos_planner</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="va">web_search_tool</span> <span class="op">&lt;-</span> <span class="fu">argent</span><span class="fu">::</span><span class="fu"><a href="../reference/tool_definitions.html">as_tool</a></span><span class="op">(</span><span class="va">web_search</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># We create a flat list of tools that the planner can use</span></span>
<span>    <span class="va">tools</span> <span class="op">&lt;-</span> <span class="fu">argent</span><span class="fu">::</span><span class="fu"><a href="../reference/flat_list.html">flat_list</a></span><span class="op">(</span><span class="va">web_search_tool</span>, <span class="va">get_todos_planner_tool</span>, <span class="va">set_todos_planner_tool</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">planner</span><span class="op">$</span><span class="fu">chat</span><span class="op">(</span><span class="va">planning_prompt</span>, system <span class="op">=</span> <span class="va">planning_system</span>, tools <span class="op">=</span> <span class="va">tools</span><span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        plan <span class="op">=</span> <span class="fu">get_todos_planner</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        handoff_summary <span class="op">=</span> <span class="va">planner</span><span class="op">$</span><span class="fu">get_content_text</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div>
<blockquote>
<p><strong>Warning</strong></p>
<p>Don’t forget to add the namespaces for ALL the functions you use when defining tools, otherwise, parallel tool calling will fail.</p>
</blockquote>
</div>
</section><section class="level2"><h3 id="research-sub-agent">Research Sub-Agent<a class="anchor" aria-label="anchor" href="#research-sub-agent"></a>
</h3>
<p>The research sub-agent executes specific research tasks using web search, web fetch, and GitHub MCP tools.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">research_subagent</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">subtask</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co">#' @description Creates a research sub-agent that executes a specific research task using</span></span>
<span>    <span class="co">#'   web search, web fetch, and GitHub tools. Use this for deep-dive information gathering.</span></span>
<span>    <span class="co">#' @param subtask:string* The specific research sub-task to execute. It must be a specific</span></span>
<span>    <span class="co">#'   task/topic with a limited scope.</span></span>
<span></span>
<span>    <span class="va">researcher</span> <span class="op">&lt;-</span> <span class="fu">argent</span><span class="fu">::</span><span class="va"><a href="../reference/OpenRouter.html">OpenRouter</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>default_model <span class="op">=</span> <span class="st">"x-ai/grok-4.1-fast"</span>, auto_save_history <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">system</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html" class="external-link">str_glue</a></span><span class="op">(</span></span>
<span>        <span class="st">"You are a Senior Research Specialist.</span></span>
<span><span class="st">        You will be given a specific research task to execute thoroughly.</span></span>
<span><span class="st"></span></span>
<span><span class="st">        &lt;responsibilities&gt;</span></span>
<span><span class="st">        - Use `web_search` to find diverse and authoritative sources.</span></span>
<span><span class="st">        - Use `web_fetch` to read full content of promising pages.</span></span>
<span><span class="st">        - Use GitHub MCP tools to explore code examples where relevant.</span></span>
<span><span class="st">        - Cross-reference information to ensure accuracy.</span></span>
<span><span class="st">        &lt;/responsibilities&gt;</span></span>
<span><span class="st"></span></span>
<span><span class="st">        &lt;output_format&gt;</span></span>
<span><span class="st">        Return your findings in a structured Markdown format:</span></span>
<span><span class="st">        # Executive Summary</span></span>
<span><span class="st">        (Brief overview of findings)</span></span>
<span><span class="st"></span></span>
<span><span class="st">        # Key Findings</span></span>
<span><span class="st">        (Detailed analysis, grouped by concepts)</span></span>
<span><span class="st"></span></span>
<span><span class="st">        # Source/Code Analysis</span></span>
<span><span class="st">        (Specific details from code or technical docs)</span></span>
<span><span class="st"></span></span>
<span><span class="st">        # References</span></span>
<span><span class="st">        (List of all URLs and repos visited)</span></span>
<span><span class="st">        &lt;/output_format&gt;</span></span>
<span><span class="st"></span></span>
<span><span class="st">        The current date is {lubridate::today()}."</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="va">prompt</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html" class="external-link">str_glue</a></span><span class="op">(</span><span class="st">"Here is the task to research:\\n\\n&lt;subtask&gt;\\n{subtask}\\n&lt;/subtask&gt;"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">web_search_tool</span> <span class="op">&lt;-</span> <span class="fu">argent</span><span class="fu">::</span><span class="fu"><a href="../reference/tool_definitions.html">as_tool</a></span><span class="op">(</span><span class="va">web_search</span><span class="op">)</span></span>
<span>    <span class="va">web_fetch_tool</span> <span class="op">&lt;-</span> <span class="fu">argent</span><span class="fu">::</span><span class="fu"><a href="../reference/tool_definitions.html">as_tool</a></span><span class="op">(</span><span class="va">web_fetch</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">tools</span> <span class="op">&lt;-</span> <span class="fu">argent</span><span class="fu">::</span><span class="fu"><a href="../reference/flat_list.html">flat_list</a></span><span class="op">(</span><span class="va">web_search_tool</span>, <span class="va">web_fetch_tool</span>, <span class="va">github_mcp_tools</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">researcher</span><span class="op">$</span><span class="fu">chat</span><span class="op">(</span><span class="va">prompt</span>, system <span class="op">=</span> <span class="va">system</span>, tools <span class="op">=</span> <span class="va">tools</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">researcher</span><span class="op">$</span><span class="fu">get_content_text</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</section><section class="level2"><h3 id="main-agent">Main Agent<a class="anchor" aria-label="anchor" href="#main-agent"></a>
</h3>
<p>The main agent coordinates the workflow: it calls the planner, delegates tasks to researchers, and synthesizes results.</p>
<p>Let’s define the main agent’s system prompt and prompt:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">main_agent</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/OpenRouter.html">OpenRouter</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>default_model <span class="op">=</span> <span class="st">"x-ai/grok-4.1-fast"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">main_system</span> <span class="op">&lt;-</span> <span class="st">"You are the Project Lead and Orchestrator.</span></span>
<span><span class="st">Your goal is to deliver high-quality results by effectively delegating work to specialized sub-agents.</span></span>
<span><span class="st"></span></span>
<span><span class="st">&lt;workflow&gt;</span></span>
<span><span class="st">1. PLAN: Call `planning_subagent` to create a roadmap for the user's request.</span></span>
<span><span class="st">2. DELEGATE: Iterate through the plan and delegate tasks to `research_subagent`.</span></span>
<span><span class="st">3. REVIEW: Analyze the findings returned by the researchers.</span></span>
<span><span class="st">4. SYNTHESIZE: Compile the final answer for the user based on all research, using the provided output schema.</span></span>
<span><span class="st">&lt;/workflow&gt;</span></span>
<span><span class="st"></span></span>
<span><span class="st">&lt;tools&gt;</span></span>
<span><span class="st">- `planning_subagent`: Use this ONCE at the start to get a list of tasks.</span></span>
<span><span class="st">- `research_subagent`: Use this for EACH task in the plan to get detailed information.</span></span>
<span><span class="st">    A task must be a specific task/topic with a limited scope.</span></span>
<span><span class="st">&lt;/tools&gt;</span></span>
<span><span class="st">"</span></span>
<span></span>
<span><span class="va">main_prompt</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">Research all LLM-adjacent packages in R, such as:</span></span>
<span><span class="st">LLM APIs, prompt engineering, embeddings, vector databases, RAG, AI agents, MCPs, and LLM tooling.</span></span>
<span><span class="st"></span></span>
<span><span class="st">For each package, identify:</span></span>
<span><span class="st">1. The package name</span></span>
<span><span class="st">2. Its GitHub repository URL</span></span>
<span><span class="st">3. Its main purpose and functionality</span></span>
<span><span class="st">4. Which other LLM-adjacent packages from your findings it is depended on or imports</span></span>
<span><span class="st"></span></span>
<span><span class="st">Stop once you've found 20 packages.</span></span>
<span><span class="st">"</span></span></code></pre></div>
</div>
<p>Then, let’s define the main agent’s output schema and tools:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">main_output_schema</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tool_definitions.html">schema</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"r_llm_packages"</span>,</span>
<span>    description <span class="op">=</span> <span class="st">"A comprehensive list of LLM-adjacent R packages"</span>,</span>
<span>    packages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        type <span class="op">=</span> <span class="st">"[object]*"</span>,</span>
<span>        description <span class="op">=</span> <span class="st">"Array of package objects"</span>,</span>
<span>        package_name <span class="op">=</span> <span class="st">"string* Package name"</span>,</span>
<span>        package_repo <span class="op">=</span> <span class="st">"string* GitHub repository URL"</span>,</span>
<span>        package_description <span class="op">=</span> <span class="st">"string* Brief description of the package's main purpose"</span>,</span>
<span>        package_dependencies <span class="op">=</span> <span class="st">"[string]* List of other LLM-adjacent packages this package depends on/imports"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">main_tools</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/tool_definitions.html">as_tool</a></span><span class="op">(</span><span class="va">planning_subagent</span><span class="op">)</span>, <span class="fu"><a href="../reference/tool_definitions.html">as_tool</a></span><span class="op">(</span><span class="va">research_subagent</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Now, let’s run the main agent:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">main_agent</span><span class="op">$</span><span class="fu">chat</span><span class="op">(</span></span>
<span>    <span class="va">main_prompt</span>,</span>
<span>    system <span class="op">=</span> <span class="va">main_system</span>,</span>
<span>    tools <span class="op">=</span> <span class="va">main_tools</span>,</span>
<span>    output_schema <span class="op">=</span> <span class="va">main_output_schema</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<p>Finally, we can print the main agent’s output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">main_agent</span>, show_tools <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Entirety of the chat history of the main agent</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">main_agent</span><span class="op">$</span><span class="fu">get_content_text</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Just the final answer of the main agent</span></span></code></pre></div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"packages"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_name"</span><span class="fu">:</span> <span class="st">"ellmer"</span><span class="fu">,</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_repo"</span><span class="fu">:</span> <span class="st">"https://github.com/tidyverse/ellmer"</span><span class="fu">,</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_description"</span><span class="fu">:</span> <span class="st">"Unified tidy chat interface for LLM APIs (OpenAI, Anthropic,</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="st">        Gemini, Ollama, etc.); streaming, tools, structured output, auto-creds."</span><span class="fu">,</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_dependencies"</span><span class="fu">:</span> <span class="ot">[]</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_name"</span><span class="fu">:</span> <span class="st">"tidyllm"</span><span class="fu">,</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_repo"</span><span class="fu">:</span> <span class="st">"https://github.com/edubruell/tidyllm"</span><span class="fu">,</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_description"</span><span class="fu">:</span> <span class="st">"Tidy verbs/pipelines for LLMs (Claude, OpenAI, Gemini, Ollama);</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="st">        embeddings, chaining, rate limits."</span><span class="fu">,</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_dependencies"</span><span class="fu">:</span> <span class="ot">[]</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_name"</span><span class="fu">:</span> <span class="st">"LLMR"</span><span class="fu">,</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_repo"</span><span class="fu">:</span> <span class="st">"https://github.com/asanaei/LLMR"</span><span class="fu">,</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_description"</span><span class="fu">:</span> <span class="st">"Unified API with batching, retries, embeddings, structured output</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="st">        (OpenAI/Azure/Mistral/Ollama)."</span><span class="fu">,</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_dependencies"</span><span class="fu">:</span> <span class="ot">[]</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_name"</span><span class="fu">:</span> <span class="st">"ollamar"</span><span class="fu">,</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_repo"</span><span class="fu">:</span> <span class="st">"https://github.com/hauselin/ollama-r"</span><span class="fu">,</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_description"</span><span class="fu">:</span> <span class="st">"Local Ollama API client for chat/completions/embeddings; parallel</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="st">        via httr2."</span><span class="fu">,</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_dependencies"</span><span class="fu">:</span> <span class="ot">[]</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_name"</span><span class="fu">:</span> <span class="st">"localLLM"</span><span class="fu">,</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_repo"</span><span class="fu">:</span> <span class="st">"https://github.com/EddieYang211/localLLM"</span><span class="fu">,</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_description"</span><span class="fu">:</span> <span class="st">"Lightweight llama.cpp bindings for local GGUF LLMs in R</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="st">        (no server)."</span><span class="fu">,</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_dependencies"</span><span class="fu">:</span> <span class="ot">[]</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_name"</span><span class="fu">:</span> <span class="st">"btw"</span><span class="fu">,</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_repo"</span><span class="fu">:</span> <span class="st">"https://github.com/posit-dev/btw"</span><span class="fu">,</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_description"</span><span class="fu">:</span> <span class="st">"R env/object/package inspector for LLM prompts; tools for ellmer</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="st">        chats/agents."</span><span class="fu">,</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_dependencies"</span><span class="fu">:</span> <span class="st">"ellmer"</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_name"</span><span class="fu">:</span> <span class="st">"tidyprompt"</span><span class="fu">,</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_repo"</span><span class="fu">:</span> <span class="st">"https://github.com/KennispuntTwente/tidyprompt"</span><span class="fu">,</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_description"</span><span class="fu">:</span> <span class="st">"Prompt 'wraps' for engineering/chaining (JSON/reasoning/tools);</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a><span class="st">        provider-agnostic."</span><span class="fu">,</span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_dependencies"</span><span class="fu">:</span> <span class="ot">[]</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_name"</span><span class="fu">:</span> <span class="st">"ragnar"</span><span class="fu">,</span></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_repo"</span><span class="fu">:</span> <span class="st">"https://github.com/tidyverse/ragnar"</span><span class="fu">,</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_description"</span><span class="fu">:</span> <span class="st">"End-to-end RAG: chunking, embeddings, hybrid retrieval, LLM</span></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a><span class="st">        integration."</span><span class="fu">,</span></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_dependencies"</span><span class="fu">:</span> <span class="ot">[</span><span class="st">"ellmer"</span><span class="ot">,</span> <span class="st">"btw"</span><span class="ot">]</span></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_name"</span><span class="fu">:</span> <span class="st">"LLMAgentR"</span><span class="fu">,</span></span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_repo"</span><span class="fu">:</span> <span class="st">"https://github.com/knowusuboaky/LLMAgentR"</span><span class="fu">,</span></span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_description"</span><span class="fu">:</span> <span class="st">"Graph-based agents for R tasks (data wrangling/viz/forecasting</span></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a><span class="st">        via tidymodels)."</span><span class="fu">,</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_dependencies"</span><span class="fu">:</span> <span class="st">"ellmer"</span></span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_name"</span><span class="fu">:</span> <span class="st">"chattr"</span><span class="fu">,</span></span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_repo"</span><span class="fu">:</span> <span class="st">"https://github.com/mlverse/chattr"</span><span class="fu">,</span></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_description"</span><span class="fu">:</span> <span class="st">"Interactive Shiny/console LLM chats; ellmer backend."</span><span class="fu">,</span></span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_dependencies"</span><span class="fu">:</span> <span class="st">"ellmer"</span></span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_name"</span><span class="fu">:</span> <span class="st">"gptstudio"</span><span class="fu">,</span></span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_repo"</span><span class="fu">:</span> <span class="st">"https://github.com/MichelNivard/gptstudio"</span><span class="fu">,</span></span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_description"</span><span class="fu">:</span> <span class="st">"RStudio addins for LLM code/doc tasks (OpenAI/Anthropic/Cohere)."</span><span class="fu">,</span></span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_dependencies"</span><span class="fu">:</span> <span class="ot">[]</span></span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_name"</span><span class="fu">:</span> <span class="st">"ragent"</span><span class="fu">,</span></span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_repo"</span><span class="fu">:</span> <span class="st">"https://github.com/cynkra/ragent"</span><span class="fu">,</span></span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_description"</span><span class="fu">:</span> <span class="st">"Simple Ollama-based agents with tools (calc/RAG)."</span><span class="fu">,</span></span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_dependencies"</span><span class="fu">:</span> <span class="st">"ollamar"</span></span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_name"</span><span class="fu">:</span> <span class="st">"mini007"</span><span class="fu">,</span></span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_repo"</span><span class="fu">:</span> <span class="st">"https://github.com/feddelegrand7/mini007"</span><span class="fu">,</span></span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_description"</span><span class="fu">:</span> <span class="st">"Lightweight multi-agent orchestration (R6 classes, delegation)."</span><span class="fu">,</span></span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_dependencies"</span><span class="fu">:</span> <span class="st">"ellmer"</span></span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_name"</span><span class="fu">:</span> <span class="st">"mcptools"</span><span class="fu">,</span></span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_repo"</span><span class="fu">:</span> <span class="st">"https://github.com/posit-dev/mcptools"</span><span class="fu">,</span></span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_description"</span><span class="fu">:</span> <span class="st">"MCP server/client for R-LLM integration (Claude Desktop/Copilot)."</span><span class="fu">,</span></span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_dependencies"</span><span class="fu">:</span> <span class="ot">[</span><span class="st">"ellmer"</span><span class="ot">,</span> <span class="st">"btw"</span><span class="ot">]</span></span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_name"</span><span class="fu">:</span> <span class="st">"rchroma"</span><span class="fu">,</span></span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_repo"</span><span class="fu">:</span> <span class="st">"https://github.com/cynkra/rchroma"</span><span class="fu">,</span></span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_description"</span><span class="fu">:</span> <span class="st">"ChromaDB client for vector storage/query (RAG enabler)."</span><span class="fu">,</span></span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_dependencies"</span><span class="fu">:</span> <span class="ot">[]</span></span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-102"><a href="#cb13-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb13-103"><a href="#cb13-103" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_name"</span><span class="fu">:</span> <span class="st">"RAGFlowChainR"</span><span class="fu">,</span></span>
<span id="cb13-104"><a href="#cb13-104" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_repo"</span><span class="fu">:</span> <span class="st">"https://github.com/knowusuboaky/RAGFlowChainR"</span><span class="fu">,</span></span>
<span id="cb13-105"><a href="#cb13-105" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_description"</span><span class="fu">:</span> <span class="st">"LangChain-like RAG chains w/ DuckDB vectors/web search."</span><span class="fu">,</span></span>
<span id="cb13-106"><a href="#cb13-106" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_dependencies"</span><span class="fu">:</span> <span class="st">"LLMAgentR"</span></span>
<span id="cb13-107"><a href="#cb13-107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-108"><a href="#cb13-108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb13-109"><a href="#cb13-109" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_name"</span><span class="fu">:</span> <span class="st">"tidychatmodels"</span><span class="fu">,</span></span>
<span id="cb13-110"><a href="#cb13-110" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_repo"</span><span class="fu">:</span> <span class="st">"https://github.com/AlbertRapp/tidychatmodels"</span><span class="fu">,</span></span>
<span id="cb13-111"><a href="#cb13-111" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_description"</span><span class="fu">:</span> <span class="st">"Tidymodels-inspired modular chatbots (OpenAI/Claude/Ollama)."</span><span class="fu">,</span></span>
<span id="cb13-112"><a href="#cb13-112" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_dependencies"</span><span class="fu">:</span> <span class="ot">[]</span></span>
<span id="cb13-113"><a href="#cb13-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-114"><a href="#cb13-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb13-115"><a href="#cb13-115" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_name"</span><span class="fu">:</span> <span class="st">"mall"</span><span class="fu">,</span></span>
<span id="cb13-116"><a href="#cb13-116" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_repo"</span><span class="fu">:</span> <span class="st">"https://github.com/mlverse/mall"</span><span class="fu">,</span></span>
<span id="cb13-117"><a href="#cb13-117" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_description"</span><span class="fu">:</span> <span class="st">"Row-wise LLM NLP on data frames (summ/classify via ellmer)."</span><span class="fu">,</span></span>
<span id="cb13-118"><a href="#cb13-118" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_dependencies"</span><span class="fu">:</span> <span class="st">"ellmer"</span></span>
<span id="cb13-119"><a href="#cb13-119" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-120"><a href="#cb13-120" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb13-121"><a href="#cb13-121" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_name"</span><span class="fu">:</span> <span class="st">"mcpr"</span><span class="fu">,</span></span>
<span id="cb13-122"><a href="#cb13-122" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_repo"</span><span class="fu">:</span> <span class="st">"https://github.com/chi2labs/mcpr"</span><span class="fu">,</span></span>
<span id="cb13-123"><a href="#cb13-123" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_description"</span><span class="fu">:</span> <span class="st">"MCP framework for R servers/clients (w/ llmr)."</span><span class="fu">,</span></span>
<span id="cb13-124"><a href="#cb13-124" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_dependencies"</span><span class="fu">:</span> <span class="ot">[]</span></span>
<span id="cb13-125"><a href="#cb13-125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb13-126"><a href="#cb13-126" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb13-127"><a href="#cb13-127" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_name"</span><span class="fu">:</span> <span class="st">"rmcp"</span><span class="fu">,</span></span>
<span id="cb13-128"><a href="#cb13-128" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_repo"</span><span class="fu">:</span> <span class="st">"https://github.com/finite-sample/rmcp"</span><span class="fu">,</span></span>
<span id="cb13-129"><a href="#cb13-129" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_description"</span><span class="fu">:</span> <span class="st">"Stats-focused MCP server (52 tools from CRAN)."</span><span class="fu">,</span></span>
<span id="cb13-130"><a href="#cb13-130" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"package_dependencies"</span><span class="fu">:</span> <span class="ot">[]</span></span>
<span id="cb13-131"><a href="#cb13-131" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb13-132"><a href="#cb13-132" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span></span>
<span id="cb13-133"><a href="#cb13-133" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
</details>
</div>
</section></section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://ma-riviere.com" class="external-link">Marc-Aurèle Rivière</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
